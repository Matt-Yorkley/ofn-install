version: v1.0
name: ofn-install
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: Build
    task:
      jobs:
        - name: Run site.yml
          commands:
            - sudo add-apt-repository -y --remove ppa:webupd8team/java
            - sudo apt-get --allow-releaseinfo-change update
            - checkout
            - bin/setup
            - ansible-playbook playbooks/setup.yml --limit vagrant --connection local --tags default_user
            - ansible-playbook playbooks/provision.yml --limit vagrant --connection local
            - ansible-playbook playbooks/deploy.yml --limit vagrant --connection local
